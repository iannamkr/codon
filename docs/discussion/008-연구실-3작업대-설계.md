# 008 — 연구실 3작업대 설계

> 논의일: 2026-02-19

## 배경

연구실(LabScene)의 빌드 흐름에서 "코돈 → 시퀀스 조립" 단계가 빠져있었음. 기존 2작업대(빌드대/제작대) 구조에서는 시퀀스풀의 기존 시퀀스만 선택 가능하고, 코돈풀에서 코돈 3개를 골라 새 시퀀스를 조립하는 기능이 없음.

```
Gene → [합성] → Codon → [???] → Sequence → [배치] → Build
                         ↑                    ↑
                       제작대에 있음         빌드대에 있음
                                  이 단계가 없다
```

## 외부 제안 분석

유저가 3단계 UI/UX 제안을 공유 (AI 생성 추정):
1. 룰 셋팅: 플라스미드 카드 슬롯
2. 부품 제작: 코돈 크래프팅 현미경
3. 덱 완성: 시퀀서 타임라인

### 제안의 문제점
- **기술 스택 불일치**: "React/Vue 컴포넌트" 언급 — 프로젝트는 Phaser + TypeScript
- **Step 2 설계 오류**: "하위 Gene 3개를 드래그하여 코돈 생성" — 실제로는 Gene(A/T/G/C) 3개 조합이 코돈. SubGene은 보너스 효과
- **코드 참조 오류**: 실존하지 않는 함수 참조

## 3가지 방안 비교

### 방안 A: 현행 2작업대 유지 + 빌드대 팝업
- 슬롯 클릭 → SequencePickerPopup (700×460)
- 왼쪽: 기존 시퀀스 선택 / 오른쪽: 코돈 3개 골라 새 시퀀스 조립
- 장점: 변경 최소
- 단점: 팝업 안에 정보 압축, 크래프팅 감 약함

### 방안 B: 3작업대 (플라스미드 — 조립 — 빌드) ← **선택됨**
- 3단계 분리로 인지 부하 감소
- 각 단계에서 집중할 것 명확
- 확장성 좋음
- 단점: 구현량 큼, 패닝 2단계

### 방안 C: 2작업대 유지 + 제작대 확장 (탭/모드)
- 제작대에 [합성] [조립] 서브탭
- 장점: 패닝 1단계 유지
- 단점: 탭 속 탭 = UX 복잡

## 하위 결정 3개

### 결정 1: 플라스미드대 역할 범위 → **1-B (플라스미드 + 실험체 정보)**
- 좌측: 실험체 정보 (스탯/체질/열화)
- 우측: 플라스미드 선택 (규칙 프리뷰)
- 하단: 인벤토리 요약 (1-C 요소 가미)
- 근거: 플라스미드 선택에 실험체 상태라는 '근거'가 필요

### 결정 2: 조립대 내부 구조 → **2-B (좌우 분할: 합성-풀-조립)**
- 좌측(280px): SynthesisBench (Gene→코돈)
- 중앙(300px): CraftingInventory (코돈풀)
- 우측(340px): SequenceAssembler (코돈→시퀀스)
- 근거: 좌→우 단방향 흐름 (재료→저장고→완성품)
- GeneInfo 패널 → 컨텍스트 플로팅 툴팁으로 전환

### 결정 3: 빌드대 → 시퀀스 배치 흐름 → **3-B (팝업 + "새로 만들기" 자동 이동)**
- 빈 슬롯 클릭 → 시퀀스풀 팝업
- [새로 만들기] 클릭 → 조립대로 패닝
- 조립 확정 → 빌드대 복귀 + 해당 슬롯에 자동 배치
- pendingSlotIndex로 대상 슬롯 기억

## 보완 제안 기술적 검토

### "스탯 변동 실시간 프리뷰" → 수정 필요
- 플라스미드는 BattleConfig (전투 규칙)을 변경하지, 스탯을 직접 변경하지 않음
- "HP 450→360" 프리뷰는 부적절 → "규칙 변동 프리뷰"가 정확
- 예외: statMultiplier가 있는 순수서열의 파생 스탯 변화는 향후 확장

### "Fire 속성 코돈 시너지 추천" → 구조 오류
- 코돈에는 속성이 없음 (속성은 플라스미드를 통해 부여)
- 올바른 추천 기준: 역할 태그 기반 인접 상호작용 예측 (previewInteractions)

### "출발 슬롯 기억" → 동의
- pendingSlotIndex 상태 관리 필수

### "시퀀스 자동 네이밍" → 후순위
- MVP 범위 밖. 코돈 조합(ATG—TTT—CAT)으로 표시 충분

## 구현 계획

### 탭 순서
좌→우: 실험체 | 조립 | 빌드
기본 활성 탭: 빌드 (container.x = -1920)

### 수정/신규 파일
1. `src/ui/lab/theme.ts` — 3작업대 레이아웃 상수 (완료)
2. `src/ui/lab/WorkbenchNav.ts` — 3탭 (완료)
3. `src/ui/lab/PlasmidBench.ts` — 신규
4. `src/ui/lab/SequenceAssembler.ts` — 신규
5. `src/scenes/LabScene.ts` — 3작업대 통합

### 병렬 개발
- Worker A: PlasmidBench
- Worker B: SequenceAssembler
- Leader: Foundation + LabScene 통합
