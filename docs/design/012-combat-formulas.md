# 012. 전투 공식 & 코어 수치

## 1. HP & 데미지 시스템 — 듀얼 트랙

### 원칙: Gene ATK ≠ HP 데미지

두 개의 수치 트랙을 완전히 분리:

| 트랙 | 용도 | 결정자 |
|------|------|--------|
| **Gene ATK** | 동종 대결(A vs A) 승패 판정 | Gene 품질 (하위Gene 보정) |
| **HP 데미지** | 적/내 본체 HP 감소 | 고정 기반 + 아미노산/효소 보정 |

**왜 분리하는가:**
- ATK이 HP 데미지에 직결되면 극후반 수치 폭주 → "누가 먼저 죽창 꽂냐" 운빨겜
- 고정 데미지만 있으면 내가 키운 Gene을 내는 맛이 없음
- **분리하면**: Gene 품질 = 동종 승리(진화 쟁취)용 체급, HP 데미지 = 플레이어가 설계한 빌드(아미노산+효소)의 콤보량

### Gene ATK (동종 대결 전용)

```
Gene ATK = 기본값(10) + 하위Gene ATK 보정

예:
  [평범한 A]     = 10 + 0   = ATK 10
  [강타하는 A]   = 10 + 2   = ATK 12
  [과부하하는 A] = 10 + 3   = ATK 13
```

- 하위Gene ATK 보정은 0~5 범위 (40종 하위Gene별 개별 설정, 밸런싱 단계에서 확정)
- ATK은 **오직 동종 대결(A vs A)에서 누가 이기는가**를 결정
- 상성 판정(A>T)에는 ATK 무관 — 상성은 절대적

### HP 시스템

```
실험체 HP = 80 + (STR × 2)

예: STR 30 → HP = 80 + 60 = 140
    STR 15 → HP = 80 + 30 = 110
```

### HP 데미지 공식

| 상황 | HP 데미지 | 설명 |
|------|----------|------|
| **상성 유리 승리** | 적 HP -10 (기본) | 내 Gene이 적 Gene을 파괴 |
| **상성 불리 패배** | 내 HP -10 (기본) | 적 Gene이 내 Gene을 파괴 |
| **동종 진화** | HP 변동 없음 | 양쪽 Gene 합체 → A⁺ |
| **비상성 동등** | HP 변동 없음 | 양쪽 Survivor Pool |

기본 데미지(10) 위에 아미노산 패시브와 효소가 보정:

```
최종 HP 데미지 = 기본(10) + 아미노산 보정 + 효소 보정

예: 기본 10 + 발화샘(버스트 +20) + 촉매제(치명타 2배 적용) = 60
예: 기본 10 + 관통(경화/쉴드 무시) → 적 방어 관통하여 10 온전히 적중
예: 기본 10 - 경화(연속 패배 감소 -4) = 6
```

### 하위Gene의 전투 중 역할

하위Gene 효과(강타 +15%, 관통 DEF 무시 등)는 **기본 HP 데미지에 대한 % 보정**으로 적용:

```
[강타하는 A]가 상성 승리 시:
  기본 데미지 10 × (1 + 0.15) = 11.5 → 적 HP -11.5

[관통하는 A]가 상성 승리 시:
  기본 데미지 10, 적의 경화/쉴드 DEF 10% 무시
```

→ 하위Gene은 HP 데미지에 **간접적으로** 기여 (직접 ATK→HP가 아님)
→ 아미노산/효소의 고정 보정 위에 %가 곱해지는 구조

---

## 2. 동종 진화(A+A=A⁺) — 스탯 ×1.5 + 옵션 병합

### 핵심 개념: 옵션 병합 (Trait Merge)

동종 진화의 진짜 가치는 스탯 증가가 아니라 **하위Gene 옵션 2개를 한 몸에 합치는 것**.

```
[흡혈하는 A](ATK 11) + [강타하는 A](ATK 12)
= [흡혈하고 강타하는 A⁺](ATK 18, 흡혈+강타 양쪽 보유)
```

### 수치 공식

```
A⁺ ATK = max(A₁ ATK, A₂ ATK) × 1.5
A⁺ 하위Gene = A₁의 하위Gene + A₂의 하위Gene (최대 2개)
```

| 항목 | 공식 | 예시 |
|------|------|------|
| ATK | 둘 중 높은 쪽 × 1.5 | max(11, 12) × 1.5 = **18** |
| 하위Gene | 양쪽 모두 보유 (2개) | 흡혈 + 강타 |
| 전투 적용 | 양쪽 하위Gene 효과 동시 적용 | 흡혈(승리 시 HP 회복) + 강타(데미지 +15%) |

### 다중 진화 (A⁺ + A → A⁺⁺)

생존자가 꼬리 귀환하면 같은 타입을 다시 만날 수 있음:

```
[흡혈+강타 A⁺](ATK 18) + [관통하는 A](ATK 11)
= [흡혈+강타+관통 A⁺⁺]???
```

**기본 규칙: 하위Gene 최대 2개**
- 이미 2개 옵션을 가진 A⁺가 다시 진화하면, **ATK는 ×1.5 적용되지만 옵션은 선택** (기존 2개 유지 OR 새 것으로 교체)
- 3개 이상 옵션은 불가 — **융합 점균이 이 한계를 깨는 효소**

### 융합 점균 (효소) — 옵션 한계 돌파

```
기본: 진화 시 하위Gene 최대 2개
융합 점균 장착 시: 진화 시 하위Gene 최대 3개까지 병합 가능

[흡혈+강타 A⁺] + [관통 A] + 융합 점균
= [흡혈+강타+관통 A⁺⁺](ATK 27, 옵션 3개!)
```

→ 011 문서의 융합 점균 효과를 "스탯 2배→3배" 에서 **"옵션 한계 돌파(2개→3개)"**로 수정

### 동종 대결 판정 (ATK 비교)

동종 진화가 아닌 **동종 대결**(양쪽 모두 같은 타입)일 때:

```
내 [강타A](ATK 12) vs 적 [평범A](ATK 10)
→ ATK 비교: 12 > 10 → 내 A가 주도
→ 합체 결과: A⁺는 내 Survivor Pool로 (주도한 쪽이 소유)
→ A⁺ = max(12,10) × 1.5 = ATK 18, 하위Gene = 강타 + (적의 하위Gene)
```

ATK이 같을 경우(완전 동등):
- 양쪽 모두 A⁺를 획득 (각자 Survivor Pool)
- 또는 50:50 확률로 한쪽만 획득 (밸런싱 시 결정)

---

## 3. Survivor Pool — 꼬리 귀환 (Tail Append)

### 규칙

생존한 Gene은 **서열 맨 끝으로 이동**. 서열은 순환하며 점점 짧아짐.

```
초기 서열:  [G1][G2][G3] [G4][G5][G6] [G7][G8][G9] [G10][G11][G12]
            ─── 윈도우1 ───

라운드1: G1 승리(A>T) → G1이 서열 맨 끝으로
라운드2: G2 패배(T<A) → G2 파괴, 서열 압축
라운드3: G3 동등(A vs G) → G3 서열 맨 끝으로

서열 상태: [G4][G5][G6] [G7][G8][G9] [G10][G11][G12] [G1][G3]
           ─── 윈도우2 ───                              ↑ 생존자
→ 프레임시프트 발생! 윈도우2의 코돈 판정이 달라짐
```

### 순환 구조

서열이 줄어들면서 생존자들이 뒤에서 다시 앞으로 순환:

```
                    ┌─────────────────────────────┐
                    ↓                             │
서열: [G4][G5][G6][G10][G11][G1][G3] ──→ 끝까지 가면 다시 앞으로
      ─── 윈도우 ───

전투 후반: 살아남은 소수의 정예 Gene이 뱅글뱅글 돌며 싸움
→ "죽음의 회전목마" — 전투의 클라이맥스
```

### 탈진 데미지 (Exhaustion) — 무한 루프 방지

서열이 한 바퀴를 완전히 순환할 때마다 양쪽 본체에 강제 데미지:

```
1회전(Full Cycle) 완료 시:
  양쪽 HP -= 탈진 데미지

탈진 데미지 = 순환 횟수 × 5
  1회전: 5
  2회전: 10
  3회전: 15 (누적 30)
  → 점점 가속되어 전투 강제 종료
```

| 순환 | 탈진 데미지 | 누적 | 설명 |
|------|-----------|------|------|
| 1회전 | 5 | 5 | 가벼운 경고 |
| 2회전 | 10 | 15 | 긴장감 상승 |
| 3회전 | 15 | 30 | 심각한 압박 |
| 4회전 | 20 | 50 | 거의 확정 종료 |

→ HP 140 기준, 4~5회전이면 탈진만으로 사망
→ 전투 시간 자연스럽게 제한 (3~5분 목표에 부합)

### 전투 종료 조건

| 조건 | 설명 |
|------|------|
| **Gene 전소** | 한쪽의 서열이 완전히 비었을 때 (모든 Gene 파괴) |
| **HP 0** | 본체 HP가 0 이하 |
| 둘 중 먼저 달성된 조건으로 승패 결정 |

### 잠복성 바이러스와의 시너지

꼬리 귀환 덕분에 잠복성 바이러스(010)가 자연 발동:

```
라운드1: [A]가 승리 → Survivor Pool → 서열 끝으로
         잠복성 바이러스: 이 Gene에 "각성" 마킹

... (다른 Gene들이 싸움) ...

라운드8: 서열이 순환하여 [A]가 다시 윈도우에 등장
         잠복성 바이러스: "각성된 Gene 재등장! 스탯 영구 +X% 펌핑!"
```

---

## 전투 시뮬레이션 (풀 예시)

```
═══ 설정 ═══
내 실험체: STR 30, HP 140
내 서열: [강타A₁][은신T₂][가속G₃] [정밀G₄][폭주C₅][흡혈T₆] [반격A₇][장벽T₈][연쇄C₉] [관통A₁₀][강타A₁₁][왜곡C₁₂]
내 효소: [농축 발화 촉매제] [A-스테로이드 앰플] [피의 펌프 모터] [극저온 동결 캡슐]

적 실험체: STR 25, HP 130
적 서열: [보호T][폭발A][정화T] [적응G][침식A][은신T] [가속G][반격C][흡혈T] [강타A][회복T][왜곡C]

═══ Phase 1 (윈도우: 강타A₁/은신T₂/가속G₃) ═══
코돈 판정: A-T-G → 트레오닌(Thr) → 🔴 천공 쐐기(방어 관통) 발동!
효소 체크: A-스테로이드 앰플 → 윈도우에 A 1개 (조건 미충족)
           농축 발화 촉매제 → 파괴 아미노산 발동 → 30% 치명타 활성!

라운드1: 강타A₁(ATK 12) vs 보호T → A>T 상성 승리!
         기본 10 + 강타(+15%) = 11.5 + 천공(쉴드 관통)
         적 HP: 130 → 118.5
         피의 펌프 모터: 킬! 공격력 영구 +2 (누적: 2)
         강타A₁ → 서열 끝으로

라운드2: 은신T₂ vs 폭발A → T<A 상성 패배!
         적 기본 10 + 폭발(+20%) = 12
         내 HP: 140 → 128
         은신T₂ 파괴

라운드3: 가속G₃ vs 정화T → G vs T = 비상성(동등)
         양쪽 Survivor Pool → 서열 끝으로

═══ Phase 2 (윈도우: 정밀G₄/폭주C₅/흡혈T₆) ═══
코돈 판정: G-C-T → 알라닌(Ala) → 🟢 반응성 굳은살(패배 시 피해 감소) 발동!
프레임시프트로 코돈이 바뀜! 천공 쐐기 → 반응성 굳은살

라운드4: 정밀G₄ vs 적응G → 동종! ATK 비교: 정밀(11) vs 적응(10) → 내가 주도
         → G⁺(ATK 16.5, 정밀+적응) 내 Survivor Pool → 서열 끝으로

라운드5: 폭주C₅ vs 침식A → C>A 상성 승리!
         기본 10 + 폭주 보정 + 모터 누적(+2) = 14
         적 HP: 118.5 → 104.5
         모터 누적: +4
         폭주C₅ → 서열 끝으로

... (계속) ...

═══ 후반: 죽음의 회전목마 ═══
서열 상태: [강타A₁][G⁺₄][폭주C₅][강타A₁₁] (4개만 생존, 순환 중)
모터 누적: +14
탈진: 2회전째, 누적 15 데미지
→ 소수 정예가 뱅글뱅글 돌며 적 HP를 깎아내림
```

---

## 변경 이력

| 날짜 | 내용 |
|------|------|
| 2026-02-19 | 초안 작성 — HP/데미지 듀얼 트랙, 동종 진화 옵션 병합, 꼬리 귀환 |
